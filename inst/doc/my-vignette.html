<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Markus Burkhardt &amp; Johannes Titz" />


<title>cofad</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">cofad</h1>
<h4 class="author">Markus Burkhardt &amp; Johannes Titz</h4>
<h4 class="date">26 August, 2019</h4>



<div id="citation" class="section level2">
<h2>Citation</h2>
<p>If you use cofad, please cite it in your work as:</p>
<p>Burkhardt, M., &amp; Titz, J. (2019). cofad: Contrast analysis for factorial designs. R package version 0.1.0. <a href="https://CRAN.R-project.org/package=cofad" class="uri">https://CRAN.R-project.org/package=cofad</a></p>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Cofad is an R package for conducting COntrast analysis in FActorial Designs like ANOVAs. If contrast analysis was to win a price it would be the one for the most underestimated, underused statistical technique. This is a pitty because in every case a contrast analysis is at least as good as an ANOVA, but in most cases it is actually better. To the question why, the simplest answer is that contrast analysis gets rid off the unspecific omnibus-hypothesis <em>there are differences somewhere</em> and substitutes it with a very specific numerical hypothesis. Furthermore, contrast analysis focuses on effects instead of significance. This is expressed doubly: First, there are three different effect sizes for contrast analysis: <span class="math inline">\(r_\mathrm{effectsize}\)</span>, <span class="math inline">\(r_\mathrm{contrast}\)</span> and <span class="math inline">\(r_\mathrm{alerting}\)</span>. Second, the effect size refers not to the data but to the tested hypothesis. The larger the effect, the more this speaks for the hypothesis. One can even compare different hypotheses against each other (hello experimentum crucis) by looking at the effect size for each hypothesis.</p>
<p>If we sparked your interest we recommend to read some introductory literature like <span class="citation">Rosenthal, Rosnow, &amp; Rubin (2000)</span>, <span class="citation">Furr (2004)</span>, or, for the German-speaking audience, <span class="citation">Sedlmeier &amp; Renkewitz (2018)</span>. Contrast analysis is actually really easy to understand if you know what a correlation is. In this vignette we assume you know some basics about contrast analysis and want to use it for your own data. We will start with between-subjects designs and then show applications for within designs and mixed designs.</p>
</div>
<div id="between-subjects-designs" class="section level2">
<h2>Between-Subjects Designs</h2>
<p>Let us first load the package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(cofad)</a></code></pre></div>
<p>Now we need some data and hypotheses. We can simply take the data from <span class="citation">Furr (2004)</span>, where we have different empathy ratings of students from different majors.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">empathy =</span> <span class="kw">c</span>(<span class="dv">51</span>, <span class="dv">56</span>, <span class="dv">61</span>, <span class="dv">58</span>, <span class="dv">54</span>, <span class="dv">62</span>, <span class="dv">67</span>, <span class="dv">57</span>, <span class="dv">65</span>, <span class="dv">59</span>, <span class="dv">50</span>, <span class="dv">49</span>, <span class="dv">47</span>, <span class="dv">45</span>,</a>
<a class="sourceLine" id="cb2-2" title="2">                            <span class="dv">44</span>, <span class="dv">50</span>, <span class="dv">45</span>, <span class="dv">40</span>, <span class="dv">49</span>, <span class="dv">41</span>),</a>
<a class="sourceLine" id="cb2-3" title="3">                <span class="dt">major =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;psychology&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;business&quot;</span>,</a>
<a class="sourceLine" id="cb2-4" title="4">                              <span class="st">&quot;chemistry&quot;</span>), <span class="dt">each =</span> <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw">head</span>(d)</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt;   empathy      major</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; 1      51 psychology</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; 2      56 psychology</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; 3      61 psychology</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; 4      58 psychology</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; 5      54 psychology</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt; 6      62  education</span></a></code></pre></div>
<p>Furr states three hypotheses:</p>
<ul>
<li>Contrast A: Psychology majors have higher empathy scores than Education majors (<span class="math inline">\(\lambda_\mathrm{psych} = 1, \lambda_\mathrm{edu} = -1\)</span>).</li>
<li>Contrast B: Business majors have higher empathy scores than Chemistry majors (<span class="math inline">\(\lambda_\mathrm{bus} = 1, \lambda_\mathrm{chem} = -1\)</span>).</li>
<li>Contrast C: On average, Psychology and Education majors have higher empathy scores than Business and Chemistry majors (<span class="math inline">\(\lambda_\mathrm{psych} = 1, \lambda_\mathrm{edu} = 1, \lambda_\mathrm{bus} = -1, \lambda_\mathrm{chem} = -1\)</span>).</li>
</ul>
<p>These hypotheses are only mean comparisons, but this is a good way to start. Let’s use cofad to conduct the contrast analysis:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">ca &lt;-<span class="st"> </span><span class="kw">calc_contrast</span>(<span class="dt">dv =</span> empathy, <span class="dt">between =</span> major,</a>
<a class="sourceLine" id="cb3-2" title="2">                    <span class="dt">lambda_between =</span> <span class="kw">c</span>(<span class="st">&quot;psychology&quot;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;education&quot;</span> =<span class="st"> </span><span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb3-3" title="3">                                       <span class="st">&quot;business&quot;</span> =<span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;chemistry&quot;</span> =<span class="st"> </span><span class="dv">0</span>),</a>
<a class="sourceLine" id="cb3-4" title="4">                    <span class="dt">data =</span> d)</a>
<a class="sourceLine" id="cb3-5" title="5">ca</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; Contrast Analysis for between factor design</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; F(1,16) = 6.154; p = 0.02461087</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; Contrasts:  business = 0; chemistry = 0; education = -1; psychology = 1</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; r_effectsize = -0.276  CAVE: F-Value for opposite contrast</span></a></code></pre></div>
<p>The print method only shows some basic information, but we can use the summary method for more details:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">summary</span>(ca)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt; $`F-Table`</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt;            SS df     MS     F     p</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; contrast   90  1 90.000 6.154 0.025</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt; within    234 16 14.625    NA    NA</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; total    1179 19     NA    NA    NA</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt; $Effects</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt;              effects</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; r_effectsize  -0.276</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt; r_contrast     0.527</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt; r_alerting    -0.309</span></a></code></pre></div>
<p>From this table, <span class="math inline">\(r_\mathrm{effectsize}\)</span> is probably the most useful statistic. It is just the correlation between the lambdas and the dependent variable, which can also easily by calculated manually:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">lambdas &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">-1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">each =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">cor</span>(d<span class="op">$</span>empathy, lambdas)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt; [1] -0.2762895</span></a></code></pre></div>
<p>The other two hypotheses can be tested accordingly:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">ca &lt;-<span class="st"> </span><span class="kw">calc_contrast</span>(<span class="dt">dv =</span> empathy, <span class="dt">between =</span> major,</a>
<a class="sourceLine" id="cb6-2" title="2">                    <span class="dt">lambda_between =</span> <span class="kw">c</span>(<span class="st">&quot;psychology&quot;</span> =<span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;education&quot;</span> =<span class="st"> </span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb6-3" title="3">                                       <span class="st">&quot;business&quot;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;chemistry&quot;</span> =<span class="st"> </span><span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb6-4" title="4">                    <span class="dt">data =</span> d)</a>
<a class="sourceLine" id="cb6-5" title="5">ca</a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt; Contrast Analysis for between factor design</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; F(1,16) = 0.684; p = 0.42045621</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; Contrasts:  business = 1; chemistry = -1; education = 0; psychology = 0</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt; r_effectsize = 0.092</span></a>
<a class="sourceLine" id="cb6-12" title="12">ca &lt;-<span class="st"> </span><span class="kw">calc_contrast</span>(<span class="dt">dv =</span> empathy, <span class="dt">between =</span> major,</a>
<a class="sourceLine" id="cb6-13" title="13">                    <span class="dt">lambda_between =</span> <span class="kw">c</span>(<span class="st">&quot;psychology&quot;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;education&quot;</span> =<span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb6-14" title="14">                                       <span class="st">&quot;business&quot;</span> =<span class="st"> </span><span class="dv">-1</span>, <span class="st">&quot;chemistry&quot;</span> =<span class="st"> </span><span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb6-15" title="15">                    <span class="dt">data =</span> d)</a>
<a class="sourceLine" id="cb6-16" title="16">ca</a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; Contrast Analysis for between factor design</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co">#&gt; F(1,16) = 57.778; p = 1.07e-06</span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="co">#&gt; Contrasts:  business = -1; chemistry = -1; education = 1; psychology = 1</span></a>
<a class="sourceLine" id="cb6-22" title="22"><span class="co">#&gt; r_effectsize = 0.847</span></a></code></pre></div>
<p>You will find that the numbers are identical to the ones presented in <span class="citation">Furr (2004)</span>. Now, imagine we have a more fun hypothesis and not just mean differences. From an elaborate theory we could derive that the means should be 73, 61, 51 and 38. We can test this with cofad directly because cofad will transfer the chosen lambdas into proper lambdas (the mean of the lambdas has to be 0):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">ca &lt;-<span class="st"> </span><span class="kw">calc_contrast</span>(<span class="dt">dv =</span> empathy, <span class="dt">between =</span> major,</a>
<a class="sourceLine" id="cb7-2" title="2">                    <span class="dt">lambda_between =</span> <span class="kw">c</span>(<span class="st">&quot;psychology&quot;</span> =<span class="st"> </span><span class="dv">73</span>, <span class="st">&quot;education&quot;</span> =<span class="st"> </span><span class="dv">61</span>,</a>
<a class="sourceLine" id="cb7-3" title="3">                                       <span class="st">&quot;business&quot;</span> =<span class="st"> </span><span class="dv">51</span>, <span class="st">&quot;chemistry&quot;</span> =<span class="st"> </span><span class="dv">38</span>),</a>
<a class="sourceLine" id="cb7-4" title="4">                    <span class="dt">data =</span> d)</a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; Warning in calc_contrast(dv = empathy, between = major, lambda_between =</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; c(psychology = 73, : lambdas are centered and rounded to 3 digits</span></a>
<a class="sourceLine" id="cb7-7" title="7">ca</a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; Contrast Analysis for between factor design</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt; F(1,16) = 37.466; p = 1.475e-05</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; Contrasts:  business = -4.75; chemistry = -17.75; education = 5.25; psychology = 17.25</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt; r_effectsize = 0.682</span></a></code></pre></div>
<p>The manual test shows the same effect size:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">lambdas &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">73</span>, <span class="dv">61</span>, <span class="dv">51</span>, <span class="dv">38</span>), <span class="dt">each =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">cor</span>(d<span class="op">$</span>empathy, lambdas)</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; [1] 0.6817294</span></a></code></pre></div>
<p>Let us now do an analysis for within-subjects designs.</p>
</div>
<div id="within-subjects-designs" class="section level2">
<h2>Within-Subjects Designs</h2>
<p>For within designs the calculations are quite different, but cofad takes care of it and we just have to use the within parameters <em>within</em> and <em>lambda_within</em> instead of the between equivalents. As an example we use Table 16.5 from <span class="citation">Sedlmeier &amp; Renkewitz (2018)</span>. Reading ability was assessed for eight participants under four different conditions. The hypothesis is that you can read best wihout music, white noise reduces your reading ability and music (independent of type) reduces it even further.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">reading_test =</span> <span class="kw">c</span>(<span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">33</span>, <span class="dv">31</span>, <span class="dv">35</span>,</a>
<a class="sourceLine" id="cb9-2" title="2">                                 <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">32</span>, <span class="dv">29</span>, <span class="dv">28</span>, <span class="dv">30</span>, <span class="dv">32</span>, <span class="dv">34</span>,</a>
<a class="sourceLine" id="cb9-3" title="3">                                 <span class="dv">21</span>, <span class="dv">25</span>, <span class="dv">23</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">26</span>, <span class="dv">29</span>, <span class="dv">31</span>, </a>
<a class="sourceLine" id="cb9-4" title="4">                                 <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">24</span>, <span class="dv">28</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">32</span>),</a>
<a class="sourceLine" id="cb9-5" title="5">                <span class="dt">participant =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="dv">4</span>)),</a>
<a class="sourceLine" id="cb9-6" title="6">                <span class="dt">music =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;without music&quot;</span>, <span class="st">&quot;white noise&quot;</span>, <span class="st">&quot;classic&quot;</span>, <span class="st">&quot;jazz&quot;</span>), <span class="dt">each =</span> <span class="dv">8</span>))</a>
<a class="sourceLine" id="cb9-7" title="7"><span class="kw">head</span>(d)</a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt;   reading_test participant         music</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt; 1           27           1 without music</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt; 2           25           2 without music</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt; 3           30           3 without music</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt; 4           29           4 without music</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; 5           30           5 without music</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#&gt; 6           33           6 without music</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="kw">calc_contrast</span>(<span class="dt">dv =</span> reading_test, <span class="dt">within =</span> music,</a>
<a class="sourceLine" id="cb9-16" title="16">              <span class="dt">lambda_within =</span> <span class="kw">c</span>(<span class="st">&quot;without music&quot;</span> =<span class="st"> </span><span class="fl">1.25</span>, </a>
<a class="sourceLine" id="cb9-17" title="17">                                <span class="st">&quot;white noise&quot;</span> =<span class="st"> </span><span class="fl">0.25</span>, <span class="st">&quot;classic&quot;</span> =<span class="st"> </span><span class="fl">-0.75</span>, <span class="st">&quot;jazz&quot;</span> =<span class="st"> </span><span class="fl">-0.75</span>),</a>
<a class="sourceLine" id="cb9-18" title="18">             <span class="dt">ID =</span> participant, <span class="dt">data =</span> d)</a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="co">#&gt; Contrast Analysis for within factor design</span></a>
<a class="sourceLine" id="cb9-21" title="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co">#&gt; L-Values: Mean =  5.875 ; SD =  3.154</span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co">#&gt; t(7) = 5.269; p = 0.00058101</span></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co">#&gt; Contrasts:  classic = -0.75; jazz = -0.75; white noise = 0.25; without music = 1.25</span></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="co">#&gt; g_contrast = 1.863</span></a></code></pre></div>
<p>You can see that the siginifance test is just a <span class="math inline">\(t\)</span>-test and the reported effect size is also for a mean comparison (<span class="math inline">\(g\)</span>). (The <span class="math inline">\(t\)</span>-test is one-tailed, because contrast analysis has always a specific hypotheses.) When conducting the analysis manually, we can see why:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">mtr &lt;-<span class="st"> </span><span class="kw">matrix</span>(d<span class="op">$</span>reading_test, <span class="dt">ncol =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">lambdas &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.25</span>, <span class="fl">0.25</span>, <span class="fl">-0.75</span>, <span class="fl">-0.75</span>)</a>
<a class="sourceLine" id="cb10-3" title="3">lc1 &lt;-<span class="st"> </span>mtr <span class="op">%*%</span><span class="st"> </span>lambdas</a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw">t.test</span>(lc1)</a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt;  One Sample t-test</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt; data:  lc1</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt; t = 5.2689, df = 7, p-value = 0.001162</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt; 95 percent confidence interval:</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt;  3.238361 8.511639</span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt; sample estimates:</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">#&gt; mean of x </span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">#&gt;     5.875</span></a></code></pre></div>
<p>Only the linear combination of the dependent variable and the contrast weights for each participant is needed. With these values a normal <span class="math inline">\(t\)</span>-test against 0 is conducted. While you can do this manually, using cofad is quicker and it also gives you more information such as the different effect sizes.</p>
</div>
<div id="mixed-designs" class="section level2">
<h2>Mixed Designs</h2>
<p>The idea of mixed designs is a combination of between and within factors. In this case cofad calculates the <em>L</em>-Value for the within factor, which is treated as a new dependent variable. Thereafter, these used for the between analysis. <span class="citation">Rosenthal et al. (2000)</span>, in their table 5.3, give an illustrative example: Nine children are measured four times (within), but they also belong to different groups of age (between).</p>
<p>There are two hypotheses:</p>
<ol style="list-style-type: decimal">
<li>linear increase over time (within) (<span class="math inline">\(\lambda_\mathrm{1} = -3, \lambda_\mathrm{2} = -1, \lambda_\mathrm{3} = 1, \lambda_\mathrm{4} = 3\)</span>)</li>
<li>linear increase over age (between) (<span class="math inline">\(\lambda_\mathrm{Age 8} = -1, \lambda_\mathrm{Age 10} = 0, \lambda_\mathrm{Age12} = 1\)</span>)</li>
</ol>
<p>Let’s have a look at the data and calculation:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">tab53 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb11-2" title="2">    <span class="dt">Var =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb11-3" title="3">            <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>,</a>
<a class="sourceLine" id="cb11-4" title="4">            <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">9</span>),</a>
<a class="sourceLine" id="cb11-5" title="5">    <span class="dt">age =</span> <span class="kw">as.factor</span>(</a>
<a class="sourceLine" id="cb11-6" title="6">      <span class="kw">rep</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Age 8&quot;</span>, <span class="st">&quot;Age 10&quot;</span>, <span class="st">&quot;Age 12&quot;</span>), <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)), <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb11-7" title="7">      ),</a>
<a class="sourceLine" id="cb11-8" title="8">    <span class="dt">time =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">9</span>))),</a>
<a class="sourceLine" id="cb11-9" title="9">    <span class="dt">ID =</span> <span class="kw">as.factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">4</span> ))</a>
<a class="sourceLine" id="cb11-10" title="10">    )</a>
<a class="sourceLine" id="cb11-11" title="11"><span class="kw">head</span>(tab53)</a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co">#&gt;   Var    age time ID</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co">#&gt; 1   3  Age 8    1  1</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co">#&gt; 2   1  Age 8    1  2</span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co">#&gt; 3   4  Age 8    1  3</span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">#&gt; 4   4 Age 10    1  4</span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="co">#&gt; 5   5 Age 10    1  5</span></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="co">#&gt; 6   5 Age 10    1  6</span></a>
<a class="sourceLine" id="cb11-19" title="19">lambda_within &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span> =<span class="st"> </span><span class="dv">-3</span>, <span class="st">&quot;2&quot;</span> =<span class="st"> </span><span class="dv">-1</span>, <span class="st">&quot;3&quot;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;4&quot;</span> =<span class="st"> </span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb11-20" title="20">lambda_between &lt;-<span class="kw">c</span>(<span class="st">&quot;Age 8&quot;</span> =<span class="st"> </span><span class="dv">-1</span>, <span class="st">&quot;Age 10&quot;</span> =<span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;Age 12&quot;</span> =<span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-21" title="21"></a>
<a class="sourceLine" id="cb11-22" title="22">contr_mx &lt;-<span class="st"> </span><span class="kw">calc_contrast</span>(<span class="dt">dv =</span> Var, </a>
<a class="sourceLine" id="cb11-23" title="23">                          <span class="dt">between =</span> age,</a>
<a class="sourceLine" id="cb11-24" title="24">                          <span class="dt">lambda_between =</span> lambda_between,</a>
<a class="sourceLine" id="cb11-25" title="25">                          <span class="dt">within =</span> time,</a>
<a class="sourceLine" id="cb11-26" title="26">                          <span class="dt">lambda_within =</span> lambda_within,</a>
<a class="sourceLine" id="cb11-27" title="27">                          <span class="dt">ID =</span> ID, </a>
<a class="sourceLine" id="cb11-28" title="28">                          <span class="dt">data =</span> tab53</a>
<a class="sourceLine" id="cb11-29" title="29">                          )</a>
<a class="sourceLine" id="cb11-30" title="30">contr_mx</a>
<a class="sourceLine" id="cb11-31" title="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-32" title="32"><span class="co">#&gt; Contrast Analysis for Mixed-Design:</span></a>
<a class="sourceLine" id="cb11-33" title="33"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-34" title="34"><span class="co">#&gt; F(1,6) = 20.211; p = 0.004</span></a>
<a class="sourceLine" id="cb11-35" title="35"><span class="co">#&gt; Contrasts:  Age 10 = 0 Age 12 = 1 Age 8 = -1</span></a>
<a class="sourceLine" id="cb11-36" title="36"><span class="co">#&gt; r_effectsize = 0.871</span></a></code></pre></div>
<p>The results look like a contrast analysis for between-subject designs. Again, the summary gives some more details: The effect sizes and within group means and standard errors of the <em>L</em>-values.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">summary</span>(contr_mx)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#&gt; $F_Table</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">#&gt;              SS df     MS      F     p</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">#&gt; contrast 42.667  1 42.667 20.211 0.004</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">#&gt; within   12.667  6  2.111     NA    NA</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">#&gt; total    56.222  8     NA     NA    NA</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co">#&gt; $Effects</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="co">#&gt;              effect</span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co">#&gt; r_effectsize  0.871</span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co">#&gt; r_contrast    0.878</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="co">#&gt; r_alerting    0.990</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">#&gt; $Within_Groups</span></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co">#&gt;               M        SE</span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="co">#&gt; Age 10 4.000000 1.0000000</span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="co">#&gt; Age 12 7.333333 0.8819171</span></a>
<a class="sourceLine" id="cb12-18" title="18"><span class="co">#&gt; Age 8  2.000000 0.5773503</span></a></code></pre></div>
<p>This was the introduction to cofad. If you have any suggestions you can post it on our gitlab site: <a href="https://gitlab.hrz.tu-chemnitz.de/burma--tu-chemnitz.de/cofad.git" class="uri">https://gitlab.hrz.tu-chemnitz.de/burma--tu-chemnitz.de/cofad.git</a></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-furr2004">
<p>Furr, R. M. (2004). Interpreting effect sizes in contrast analysis. <em>Understanding Statistics</em>, <em>3</em>(1), 1–25. <a href="https://doi.org/10.1207/s15328031us0301_1">https://doi.org/10.1207/s15328031us0301_1</a></p>
</div>
<div id="ref-Rosenthal2000">
<p>Rosenthal, R., Rosnow, R. L., &amp; Rubin, D. B. (2000). <em>Contrasts and effect sizes in behavioral research: A correlational approach</em>. Cambridge, England: Cambridge University Press.</p>
</div>
<div id="ref-sedlmeier2018">
<p>Sedlmeier, P., &amp; Renkewitz, F. (2018). <em>Forschungsmethoden und Statistik für Psychologen und Sozialwissenschaftler</em> (3., aktualisierte und erweiterte Auflage). Hallbergmoos, Germany: Pearson Studium.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
